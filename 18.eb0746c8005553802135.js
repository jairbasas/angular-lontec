(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{Ezu7:function(e,t,n){"use strict";n.r(t),n.d(t,"UserModule",function(){return H});var i=n("NdbC"),r=n("iInd"),a=n("36fG"),o=n("Ez0L"),s=n("cp0P"),l=n("s7LF"),b=n("8Y7J"),c=n("NFMk"),m=n("fXYU"),d=n("DWb9"),u=n("JXeA"),z=n("vU8h"),h=n("wf2+"),p=n("fb/r"),T=n("tYkK"),f=n("px0D"),U=n("jTf7"),g=n("SVse"),S=n("SBNi"),E=n("GaVp"),A=n("Jp/u"),v=n("WJhm");function P(e,t){if(1&e&&b.Pb(0,"nz-option",25),2&e){const e=t.$implicit;b.mc("nzValue",e.userTypeId)("nzLabel",e.userTypeName)}}function I(e,t){if(1&e){const e=b.Vb();b.Ub(0,"div"),b.Ub(1,"button",26),b.bc("click",function(){return b.vc(e),b.ec().onCancel()}),b.Hc(2,"Cancelar"),b.Tb(),b.Ub(3,"button",27),b.bc("click",function(){return b.vc(e),b.ec().onSubmit()}),b.Hc(4,"Guardar"),b.Tb(),b.Tb()}if(2&e){const e=b.ec();b.Ab(3),b.mc("nzLoading",e.loadingSubmit)}}let y=(()=>{class e{constructor(e,t,n,i,r,o){this.fb=e,this.modalRef=t,this.formValidator=n,this.securityService=i,this.messageService=r,this.modalMessage=o,this.state=a.a.STATE_ENTITY.ENABLE,this.userTypeList=[],this.loadingSping=!1,this.loadingSubmit=!1}ngOnInit(){this.initForm(),this.initList()}initForm(){this.frmUserEdit=this.fb.group({username:[null,[l.q.required,this.formValidator.espacionBlanco]],fatherlastname:[null,[l.q.required,this.formValidator.espacionBlanco]],motherlastname:[null,[l.q.required,this.formValidator.espacionBlanco]],ddlusertype:[null,[l.q.required,this.formValidator.espacionBlanco]],documentnumber:[null],email:[null,[this.formValidator.optionalValidateEmail]],login:[null,[l.q.required,this.formValidator.espacionBlanco]],password:[null,[l.q.required,this.formValidator.espacionBlanco]]})}initList(){Object(s.a)([this.securityService.getUserTypeSearch({state:a.a.STATE_ENTITY.ENABLE})]).subscribe(e=>{this.userTypeList=e[0]},e=>{this.messageService.error(a.a.MESSAGE.ERROR_GET_DATA)},()=>{void 0!==this.userId&&this.onSearch()})}onSearch(){this.loadingSping=!0,this.securityService.getUserById(this.userId).subscribe(e=>{this.frmUserEdit.get("username").setValue(e.userName),this.frmUserEdit.get("fatherlastname").setValue(e.fatherLastName),this.frmUserEdit.get("motherlastname").setValue(e.motherLastName),this.frmUserEdit.get("documentnumber").setValue(e.documentNumber),this.frmUserEdit.get("email").setValue(e.email),this.frmUserEdit.get("ddlusertype").setValue(e.userTypeId),this.frmUserEdit.get("login").setValue(e.login),this.frmUserEdit.get("password").setValue(a.a.COMMON.DEFAULT_PASSWORD),this.state=e.state,this.frmUserEdit.controls.password.disable(),this.loadingSping=!1},e=>{this.loadingSping=!1,this.messageService.error(a.a.MESSAGE.ERROR_GET_DATA)})}setCommand(){return{userId:this.userId,userName:this.frmUserEdit.value.username,fatherLastName:this.frmUserEdit.value.fatherlastname,motherLastName:this.frmUserEdit.value.motherlastname,documentNumber:this.frmUserEdit.value.documentnumber,email:this.frmUserEdit.value.email,login:this.frmUserEdit.value.login,password:this.frmUserEdit.value.password,state:this.state,userTypeId:this.frmUserEdit.value.ddlusertype,registerUserId:Object(o.d)(),registerUserFullname:Object(o.c)()}}onCancel(){this.modalRef.destroy()}onSubmit(){Object(o.j)(this.frmUserEdit)?this.modalMessage.confirm(a.a.MESSAGE.CONFIRM_QUESTION,()=>{this.loadingSubmit=!0,this.securityService.postUser(this.setCommand()).subscribe(e=>{this.loadingSubmit=!1,this.modalRef.destroy({confirmProcess:!0})},e=>{this.loadingSubmit=!1,this.messageService.error(a.a.MESSAGE.ERROR)})}):this.messageService.warning(a.a.MESSAGE.COMPLETE_FORM)}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(l.e),b.Ob(c.c),b.Ob(m.a),b.Ob(d.a),b.Ob(u.e),b.Ob(z.a))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-user-edit"]],inputs:{userId:"userId"},decls:60,vars:21,consts:[["nz-form","","nzLayout","vertical",3,"formGroup"],[3,"nzSpinning"],["nz-row",""],["nz-col","",3,"nzSm","nzXs"],["nzRequired","","nzFor","username"],["nzErrorTip","Campo obligatorio."],["nz-input","","formControlName","username","placeholder","Nombre Usuario"],["nzRequired","","nzFor","fatherlastname"],["nz-input","","formControlName","fatherlastname","placeholder","Apellido Paterno"],["nzRequired","","nzFor","motherlastname"],["nz-input","","formControlName","motherlastname","placeholder","Apellido Materno"],["nzFor","documentnumber"],["nz-input","","formControlName","documentnumber","placeholder","Nro. Documento"],["nzFor","email"],["nzErrorTip","Formato incorrecto."],["nz-input","","formControlName","email","placeholder","Email"],["nzRequired","","nzFor","usertype"],["nzShowSearch","","formControlName","ddlusertype","nzPlaceHolder","Tipo Usuario"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzText","Credenciales"],["nzRequired","","nzFor","login"],["nz-input","","formControlName","login","placeholder","login"],["nzRequired","","nzFor","password"],["type","password","nz-input","","formControlName","password","placeholder","Contrase\xf1a"],[4,"nzModalFooter"],[3,"nzValue","nzLabel"],["nz-button","","nzType","primary","nzDanger","",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"]],template:function(e,t){1&e&&(b.Ub(0,"form",0),b.Ub(1,"nz-spin",1),b.Ub(2,"div",2),b.Ub(3,"div",3),b.Ub(4,"nz-form-item"),b.Ub(5,"nz-form-label",4),b.Hc(6,"Nombre Usuario"),b.Tb(),b.Ub(7,"nz-form-control",5),b.Pb(8,"input",6),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(9,"div",2),b.Ub(10,"div",3),b.Ub(11,"nz-form-item"),b.Ub(12,"nz-form-label",7),b.Hc(13,"Apellido Paterno"),b.Tb(),b.Ub(14,"nz-form-control",5),b.Pb(15,"input",8),b.Tb(),b.Tb(),b.Tb(),b.Ub(16,"div",3),b.Ub(17,"nz-form-item"),b.Ub(18,"nz-form-label",9),b.Hc(19,"Apellido Materno"),b.Tb(),b.Ub(20,"nz-form-control",5),b.Pb(21,"input",10),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(22,"div",2),b.Ub(23,"div",3),b.Ub(24,"nz-form-item"),b.Ub(25,"nz-form-label",11),b.Hc(26,"Nro. Documento"),b.Tb(),b.Ub(27,"nz-form-control",5),b.Pb(28,"input",12),b.Tb(),b.Tb(),b.Tb(),b.Ub(29,"div",3),b.Ub(30,"nz-form-item"),b.Ub(31,"nz-form-label",13),b.Hc(32,"Email"),b.Tb(),b.Ub(33,"nz-form-control",14),b.Pb(34,"input",15),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(35,"div",2),b.Ub(36,"div",3),b.Ub(37,"nz-form-item"),b.Ub(38,"nz-form-label",16),b.Hc(39,"Tipo Usuario"),b.Tb(),b.Ub(40,"nz-form-control",5),b.Ub(41,"nz-select",17),b.Fc(42,P,1,2,"nz-option",18),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(43,"div",2),b.Ub(44,"div",3),b.Pb(45,"nz-divider",19),b.Tb(),b.Tb(),b.Ub(46,"div",2),b.Ub(47,"div",3),b.Ub(48,"nz-form-item"),b.Ub(49,"nz-form-label",20),b.Hc(50,"Login"),b.Tb(),b.Ub(51,"nz-form-control",5),b.Pb(52,"input",21),b.Tb(),b.Tb(),b.Tb(),b.Ub(53,"div",3),b.Ub(54,"nz-form-item"),b.Ub(55,"nz-form-label",22),b.Hc(56,"Contrase\xf1a"),b.Tb(),b.Ub(57,"nz-form-control",5),b.Pb(58,"input",23),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Fc(59,I,5,1,"div",24)),2&e&&(b.mc("formGroup",t.frmUserEdit),b.Ab(1),b.mc("nzSpinning",t.loadingSping),b.Ab(2),b.mc("nzSm",24)("nzXs",24),b.Ab(7),b.mc("nzSm",12)("nzXs",24),b.Ab(6),b.mc("nzSm",12)("nzXs",24),b.Ab(7),b.mc("nzSm",12)("nzXs",24),b.Ab(6),b.mc("nzSm",12)("nzXs",24),b.Ab(7),b.mc("nzSm",24)("nzXs",24),b.Ab(6),b.mc("ngForOf",t.userTypeList),b.Ab(2),b.mc("nzSm",24)("nzXs",24),b.Ab(3),b.mc("nzSm",12)("nzXs",24),b.Ab(6),b.mc("nzSm",12)("nzXs",24))},directives:[l.r,l.n,h.b,l.i,p.a,T.c,T.a,h.c,h.d,h.a,f.b,l.d,l.m,l.h,U.d,g.m,S.a,c.a,U.a,E.a,A.a,v.a],styles:[""]}),e})();var C=n("YdS3"),L=n("66zS"),N=n("haRT"),O=n("W4B1");function F(e,t){if(1&e&&b.Pb(0,"nz-option",20),2&e){const e=t.$implicit;b.mc("nzValue",e.parameterDetailId)("nzLabel",e.fieldValue1)}}function R(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",28),b.bc("click",function(){b.vc(e);const t=b.ec().$implicit;return b.ec().onChangeState(t.userId,t.state)}),b.Pb(1,"i",29),b.Tb()}}function M(e,t){if(1&e){const e=b.Vb();b.Ub(0,"button",30),b.bc("click",function(){b.vc(e);const t=b.ec().$implicit;return b.ec().onChangeState(t.userId,t.state)}),b.Pb(1,"i",31),b.Tb()}}function w(e,t){if(1&e){const e=b.Vb();b.Ub(0,"tr"),b.Ub(1,"td",21),b.Hc(2),b.Tb(),b.Ub(3,"td",21),b.Hc(4),b.Tb(),b.Ub(5,"td",21),b.Hc(6),b.Tb(),b.Ub(7,"td",21),b.Hc(8),b.Tb(),b.Ub(9,"td",21),b.Hc(10),b.Tb(),b.Ub(11,"td",21),b.Ub(12,"button",22),b.bc("click",function(){b.vc(e);const n=t.$implicit;return b.ec().onOpenUserEditModal(n.userId)}),b.Pb(13,"i",23),b.Tb(),b.Tb(),b.Ub(14,"td",21),b.Ub(15,"button",24),b.bc("click",function(){b.vc(e);const n=t.$implicit;return b.ec().onChangePassword(n.userId)}),b.Pb(16,"i",25),b.Tb(),b.Tb(),b.Ub(17,"td",21),b.Fc(18,R,2,0,"button",26),b.Tb(),b.Ub(19,"td",21),b.Fc(20,M,2,0,"button",27),b.Tb(),b.Tb()}if(2&e){const e=t.$implicit,n=b.ec();b.Ab(2),b.Lc("",e.userName," ",e.fatherLastName," ",e.motherLastName,""),b.Ab(2),b.Ic(e.email),b.Ab(2),b.Ic(e.userTypeName),b.Ab(2),b.Ic(e.login),b.Ab(2),b.Ic(e.stateName),b.Ab(8),b.mc("ngIf",n.state!==e.state),b.Ab(2),b.mc("ngIf",n.state===e.state)}}const V=[{path:"",component:(()=>{class e{constructor(e,t,n,i){this.fb=e,this.securityService=t,this.modalMessage=n,this.modalService=i,this.stateList=[],this.pageIndex=a.a.PAGINATION.PAGE_INDEX,this.pageSize=a.a.PAGINATION.PAGE_SIZE,this.sortProperty="",this.sortPropertyName="",this.totalRecord=0,this.state=a.a.STATE_ENTITY.ENABLE,this.tableUser=[],this.tableUserLoading=!1}ngOnInit(){this.initForm(),this.initList()}initForm(){this.frmUser=this.fb.group({name:[null],ddlstate:[null]})}initList(){Object(s.a)([this.securityService.getParameterDetailSearch({parameterId:a.a.PARAMETERS.ENTITY_STATE})]).subscribe(e=>{this.stateList=e[0]},e=>{this.modalMessage.error(a.a.MESSAGE.ERROR_GET_DATA)},()=>{this.onSearch()})}onSearch(){let e=null===this.frmUser.value.name?"":this.frmUser.value.name,t=null===this.frmUser.controls.ddlstate.value?0:this.frmUser.controls.ddlstate.value;this.tableUserLoading=!0,this.securityService.getUserFindAll({name:e,state:t,PageIndex:this.pageIndex,PageSize:this.pageSize,sort:this.sortProperty}).subscribe(e=>{this.tableUser=e.items,this.totalRecord=e.pagination.total,this.tableUserLoading=!1},e=>{this.tableUserLoading=!1,this.modalMessage.error(a.a.MESSAGE.ERROR_GET_DATA)})}onQueryParamsChange(e){const{pageSize:t,pageIndex:n,sort:i}=e;let r;this.pageIndex=n,this.pageSize=t,null!==i[0].value&&("ascend"==i[0].value&&(r="ASC"),"descend"==i[0].value&&(r="DESC"),"name"===i[0].key&&(this.sortProperty="user_name "+r)),this.onSearch()}onOpenUserEditModal(e){this.modalService.create({nzTitle:a.a.MODAL_TITLE.REGISTER_USER,nzClosable:!1,nzContent:y,nzComponentParams:{userId:e}}).afterClose.subscribe(e=>{void 0!==e&&this.onSearch()})}setCommandChangePassword(e){return{userId:e,updateUserId:Object(o.d)(),updateUserFullname:Object(o.c)()}}onChangePassword(e){this.modalMessage.confirm(a.a.MESSAGE.CONFIRM_QUESTION,()=>{this.tableUserLoading=!0,this.securityService.putChangeUserPassword(this.setCommandChangePassword(e)).subscribe(e=>{this.tableUserLoading=!1,this.modalMessage.success(a.a.MESSAGE.SUCCESS_UPDATE)},e=>{this.tableUserLoading=!1,this.modalMessage.error(a.a.MESSAGE.ERROR)})})}setCommandChangeState(e,t){return{userId:e,state:this.state===t?a.a.STATE_ENTITY.DISABLE:a.a.STATE_ENTITY.ENABLE,updateUserId:Object(o.d)(),updateUserFullname:Object(o.c)()}}onChangeState(e,t){this.modalMessage.confirm(a.a.MESSAGE.CONFIRM_QUESTION,()=>{this.tableUserLoading=!0,this.securityService.putUserChangeState(this.setCommandChangeState(e,t)).subscribe(()=>{this.onSearch()},e=>{this.tableUserLoading=!1,this.modalMessage.error(a.a.MESSAGE.ERROR)})})}}return e.\u0275fac=function(t){return new(t||e)(b.Ob(l.e),b.Ob(d.a),b.Ob(z.a),b.Ob(c.d))},e.\u0275cmp=b.Ib({type:e,selectors:[["app-user"]],decls:45,vars:29,consts:[["nz-form","","nzLayout","vertical",3,"formGroup"],["nzTitle","Usuarios de Sistema"],["nz-row",""],["nz-col","",3,"nzSm","nzXs"],["nzFor","name"],["nz-input","","formControlName","name","placeholder","Usuario"],["nzFor","ddlstate"],["nzShowSearch","","nzAllowClear","","formControlName","ddlstate","nzPlaceHolder","Estados"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"text-right"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-right","5px",3,"click"],["nz-icon","","nzType","plus"],["nz-button","","nzType","default",2,"margin-left","5px","margin-right","9px",3,"click"],["nz-icon","","nzType","search"],["nz-row","",1,"ant-form-item","mt-15"],["nzSize","small","nzShowSizeChanger","",3,"nzFrontPagination","nzLoading","nzData","nzTotal","nzPageIndex","nzPageSize","nzPageIndexChange","nzPageSizeChange","nzQueryParams"],["nzColumnKey","name",1,"tr-color",3,"nzAlign","nzSortFn"],[1,"tr-color",3,"nzAlign"],[1,"tr-color",3,"nzAlign","nzWidth"],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["nzAlign","center"],["nz-button","","nzType","primary","nzTooltipTitle","Editar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzTooltipTitle","Cambiar Contrase\xf1a","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click"],["nz-icon","","nzType","send","nzTheme","outline"],["nz-button","","nzTooltipTitle","Habilitar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click",4,"ngIf"],["nz-button","","nzTooltipTitle","Deshabilitar","nzTooltipPlacement","topLeft","nz-tooltip","","nzDanger","",3,"click",4,"ngIf"],["nz-button","","nzTooltipTitle","Habilitar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click"],["nz-icon","","nzType","like","nzTheme","outline"],["nz-button","","nzTooltipTitle","Deshabilitar","nzTooltipPlacement","topLeft","nz-tooltip","","nzDanger","",3,"click"],["nz-icon","","nzType","dislike","nzTheme","outline"]],template:function(e,t){1&e&&(b.Ub(0,"form",0),b.Ub(1,"nz-card",1),b.Ub(2,"div",2),b.Ub(3,"div",3),b.Ub(4,"nz-form-item"),b.Ub(5,"nz-form-label",4),b.Hc(6,"Usuario"),b.Tb(),b.Ub(7,"nz-form-control"),b.Pb(8,"input",5),b.Tb(),b.Tb(),b.Tb(),b.Ub(9,"div",3),b.Ub(10,"nz-form-item"),b.Ub(11,"nz-form-label",6),b.Hc(12,"Estado"),b.Tb(),b.Ub(13,"nz-form-control"),b.Ub(14,"nz-select",7),b.Fc(15,F,1,2,"nz-option",8),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(16,"div",2),b.Ub(17,"div",3),b.Ub(18,"div",9),b.Ub(19,"button",10),b.bc("click",function(){return t.onOpenUserEditModal()}),b.Pb(20,"i",11),b.Hc(21," Nuevo"),b.Tb(),b.Ub(22,"button",12),b.bc("click",function(){return t.onSearch()}),b.Pb(23,"i",13),b.Hc(24,"Buscar"),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Ub(25,"div",14),b.Ub(26,"nz-table",15),b.bc("nzPageIndexChange",function(e){return t.pageIndex=e})("nzPageSizeChange",function(e){return t.pageSize=e})("nzQueryParams",function(e){return t.onQueryParamsChange(e)}),b.Ub(27,"thead"),b.Ub(28,"tr"),b.Ub(29,"th",16),b.Hc(30,"Nombre Usuario"),b.Tb(),b.Ub(31,"th",17),b.Hc(32,"Email"),b.Tb(),b.Ub(33,"th",17),b.Hc(34,"Tipo Usuario"),b.Tb(),b.Ub(35,"th",17),b.Hc(36,"Login"),b.Tb(),b.Ub(37,"th",17),b.Hc(38,"Estado"),b.Tb(),b.Pb(39,"th",18),b.Pb(40,"th",18),b.Pb(41,"th",18),b.Pb(42,"th",18),b.Tb(),b.Tb(),b.Ub(43,"tbody"),b.Fc(44,w,21,9,"tr",19),b.Tb(),b.Tb(),b.Tb(),b.Tb(),b.Tb()),2&e&&(b.mc("formGroup",t.frmUser),b.Ab(3),b.mc("nzSm",8)("nzXs",24),b.Ab(6),b.mc("nzSm",8)("nzXs",24),b.Ab(6),b.mc("ngForOf",t.stateList),b.Ab(2),b.mc("nzSm",24)("nzXs",24),b.Ab(9),b.mc("nzFrontPagination",!1)("nzLoading",t.tableUserLoading)("nzData",t.tableUser)("nzTotal",t.totalRecord)("nzPageIndex",t.pageIndex)("nzPageSize",t.pageSize),b.Ab(3),b.mc("nzAlign","center")("nzSortFn",!0),b.Ab(2),b.mc("nzAlign","center"),b.Ab(2),b.mc("nzAlign","center"),b.Ab(2),b.mc("nzAlign","center"),b.Ab(2),b.mc("nzAlign","center"),b.Ab(2),b.mc("nzAlign","center")("nzWidth","20px"),b.Ab(1),b.mc("nzAlign","center")("nzWidth","20px"),b.Ab(1),b.mc("nzAlign","center")("nzWidth","20px"),b.Ab(1),b.mc("nzAlign","center")("nzWidth","20px"),b.Ab(2),b.mc("ngForOf",t.tableUser))},directives:[l.r,l.n,h.b,l.i,C.a,T.c,T.a,h.c,h.d,h.a,f.b,l.d,l.m,l.h,U.d,g.m,E.a,A.a,v.a,L.a,N.c,N.j,N.k,N.b,N.i,N.h,N.a,N.f,U.a,O.d,g.n],styles:[""]}),e})()}];let G=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[r.g.forChild(V)],r.g]}),e})(),H=(()=>{class e{}return e.\u0275mod=b.Mb({type:e}),e.\u0275inj=b.Lb({factory:function(t){return new(t||e)},imports:[[i.a,G]]}),e})()}}]);