(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{gRwe:function(e,n,t){"use strict";t.r(n),t.d(n,"ProfileMenuModule",function(){return x});var i=t("NdbC"),r=t("iInd"),o=t("36fG"),l=t("Ez0L"),a=t("cp0P"),s=t("s7LF"),c=t("8Y7J"),u=t("NFMk"),b=t("JXeA"),m=t("DWb9"),d=t("vU8h"),f=t("wf2+"),h=t("fb/r"),z=t("tYkK"),p=t("jTf7"),g=t("SVse"),T=t("GaVp"),S=t("Jp/u"),M=t("WJhm");function P(e,n){if(1&e&&c.Pb(0,"nz-option",12),2&e){const e=n.$implicit;c.mc("nzValue",e.systemId)("nzLabel",e.systemName)}}function E(e,n){if(1&e&&c.Pb(0,"nz-option",12),2&e){const e=n.$implicit;c.mc("nzValue",e.profileId)("nzLabel",e.profileName)}}function I(e,n){if(1&e&&c.Pb(0,"nz-option",12),2&e){const e=n.$implicit;c.mc("nzValue",e.menuId)("nzLabel",e.menuName)}}function A(e,n){if(1&e){const e=c.Vb();c.Ub(0,"div"),c.Ub(1,"button",13),c.bc("click",function(){return c.vc(e),c.ec().onCancel()}),c.Hc(2,"Cancelar"),c.Tb(),c.Ub(3,"button",14),c.bc("click",function(){return c.vc(e),c.ec().onSubmit()}),c.Hc(4,"Guardar"),c.Tb(),c.Tb()}if(2&e){const e=c.ec();c.Ab(3),c.mc("nzLoading",e.loadingSubmit)}}let L=(()=>{class e{constructor(e,n,t,i,r){this.fb=e,this.modalRef=n,this.messageService=t,this.securityService=i,this.modalMessage=r,this.state=o.a.STATE_ENTITY.ENABLE,this.loadingSubmit=!1,this.loadingSping=!1,this.systemList=[],this.profileList=[],this.menuList=[],this.menuListFiltered=[],this.profileMenuList=[]}ngOnInit(){this.initForm(),this.initList()}initForm(){this.frmProfileMenuEdit=this.fb.group({ddlsystem:[null,[s.q.required]],ddlprofile:[null,[s.q.required]],ddlmenu:[null,[s.q.required]]})}initList(){Object(a.a)([this.securityService.getMenuSearch({state:o.a.STATE_ENTITY.ENABLE}),this.securityService.getSystemSearch({state:o.a.STATE_ENTITY.ENABLE}),this.securityService.getProfileMenuSearch({})]).subscribe(e=>{this.menuList=e[0],this.systemList=e[1],this.profileMenuList=e[2]},e=>{this.messageService.error(o.a.MESSAGE.ERROR_GET_DATA)},()=>{void 0!==this.profileMenuId&&this.onSearch()})}onChangeddlsystem(e){this.profileList=[],this.frmProfileMenuEdit.get("ddlprofile").setValue(null),null!==e&&this.securityService.getProfileSearch({systemId:e,state:o.a.STATE_ENTITY.ENABLE}).subscribe(e=>this.profileList=e)}onChangeddlprofile(e){if(this.menuListFiltered=[],this.frmProfileMenuEdit.get("ddlmenu").setValue(null),null===e)return;let n,t=JSON.stringify(this.menuList);if(this.menuListFiltered=JSON.parse(t),void 0===this.profileMenuId)n=this.profileMenuList.filter(e=>Number(e.profileId)===Number(this.frmProfileMenuEdit.value.ddlprofile)),n.forEach(e=>{let n=this.menuListFiltered.findIndex(n=>Number(n.menuId)===Number(e.menuId));-1!==n&&this.menuListFiltered.splice(n,1)});else{n=this.profileMenuList.filter(n=>Number(n.profileId)===Number(e));let t=JSON.stringify(this.menuListFiltered);JSON.parse(t).forEach(e=>{let t=n.findIndex(n=>Number(n.menuId)===Number(e.menuId));-1===t&&(t=this.menuListFiltered.findIndex(n=>Number(n.menuId)===Number(e.menuId)),this.menuListFiltered.splice(t,1))})}}validate(){return void 0===this.profileMenuId||!this.profileMenuList.find(e=>Number(e.menuId)===Number(this.frmProfileMenuEdit.value.ddlmenu)&&Number(e.profileId)===Number(this.frmProfileMenuEdit.value.ddlprofile)&&Number(e.profileMenuId)!==this.profileMenuId)||(this.messageService.warning("Ya existe un registro con esta configuraci\xf3n"),!1)}onCancel(){this.modalRef.destroy()}onSearch(){this.loadingSping=!0;let e=this.profileMenuList.find(e=>Number(e.profileMenuId)===this.profileMenuId);e&&(this.loadingSping=!0,this.securityService.getProfileById(Number(e.profileId)).subscribe(n=>{this.frmProfileMenuEdit.get("ddlsystem").setValue(n.systemId),this.frmProfileMenuEdit.get("ddlprofile").setValue(e.profileId),this.frmProfileMenuEdit.get("ddlmenu").setValue(e.menuId),this.state=e.state,this.loadingSping=!1},e=>{this.loadingSping=!1,this.messageService.error(o.a.MESSAGE.ERROR_GET_DATA)}))}setCommand(){return{profileMenuId:this.profileMenuId,state:this.state,menuId:this.frmProfileMenuEdit.value.ddlmenu,profileId:this.frmProfileMenuEdit.value.ddlprofile,registerUserId:Object(l.d)(),registerUserFullname:Object(l.c)()}}onSubmit(){if(Object(l.j)(this.frmProfileMenuEdit)){if(!this.validate())return;this.modalMessage.confirm(o.a.MESSAGE.CONFIRM_QUESTION,()=>{this.loadingSubmit=!0,this.securityService.postProfileMenu(this.setCommand()).subscribe(e=>{this.loadingSubmit=!1,this.messageService.success(o.a.MESSAGE.SUCCESS_SAVE),this.modalRef.destroy({confirmProcess:!0})},e=>{this.loadingSubmit=!1,this.messageService.error(o.a.MESSAGE.ERROR)})})}else this.messageService.warning(o.a.MESSAGE.COMPLETE_FORM)}}return e.\u0275fac=function(n){return new(n||e)(c.Ob(s.e),c.Ob(u.c),c.Ob(b.e),c.Ob(m.a),c.Ob(d.a))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-profile-menu-edit"]],inputs:{profileMenuId:"profileMenuId"},decls:24,vars:11,consts:[["nz-form","","nzLayout","vertical",3,"formGroup"],[3,"nzSpinning"],["nz-col","",3,"nzSm","nzXs"],["nzRequired","","nzFor","system"],["nzErrorTip","Campo obligatorio."],["nzShowSearch","","formControlName","ddlsystem","nzPlaceHolder","Sistema",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzRequired","","nzFor","profile"],["nzShowSearch","","formControlName","ddlprofile","nzPlaceHolder","Perfil",3,"ngModelChange"],["nzRequired","","nzFor","menu"],["nzShowSearch","","formControlName","ddlmenu","nzPlaceHolder","Men\xfa"],[4,"nzModalFooter"],[3,"nzValue","nzLabel"],["nz-button","","nzType","primary","nzDanger","",3,"click"],["nz-button","","nzType","primary",3,"nzLoading","click"]],template:function(e,n){1&e&&(c.Ub(0,"form",0),c.Ub(1,"nz-spin",1),c.Ub(2,"div",2),c.Ub(3,"nz-form-item"),c.Ub(4,"nz-form-label",3),c.Hc(5,"Sistema"),c.Tb(),c.Ub(6,"nz-form-control",4),c.Ub(7,"nz-select",5),c.bc("ngModelChange",function(e){return n.onChangeddlsystem(e)}),c.Fc(8,P,1,2,"nz-option",6),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(9,"div",2),c.Ub(10,"nz-form-item"),c.Ub(11,"nz-form-label",7),c.Hc(12,"Perfil"),c.Tb(),c.Ub(13,"nz-form-control",4),c.Ub(14,"nz-select",8),c.bc("ngModelChange",function(e){return n.onChangeddlprofile(e)}),c.Fc(15,E,1,2,"nz-option",6),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(16,"div",2),c.Ub(17,"nz-form-item"),c.Ub(18,"nz-form-label",9),c.Hc(19,"Men\xfa"),c.Tb(),c.Ub(20,"nz-form-control",4),c.Ub(21,"nz-select",10),c.Fc(22,I,1,2,"nz-option",6),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Fc(23,A,5,1,"div",11)),2&e&&(c.mc("formGroup",n.frmProfileMenuEdit),c.Ab(1),c.mc("nzSpinning",n.loadingSping),c.Ab(1),c.mc("nzSm",24)("nzXs",24),c.Ab(6),c.mc("ngForOf",n.systemList),c.Ab(1),c.mc("nzSm",24)("nzXs",24),c.Ab(6),c.mc("ngForOf",n.profileList),c.Ab(1),c.mc("nzSm",24)("nzXs",24),c.Ab(6),c.mc("ngForOf",n.menuListFiltered))},directives:[s.r,s.n,f.b,s.i,h.a,z.a,z.c,f.c,f.d,f.a,p.d,s.m,s.h,g.m,u.a,p.a,T.a,S.a,M.a],styles:[""]}),e})();var U=t("YdS3"),v=t("px0D"),y=t("66zS"),N=t("haRT"),F=t("W4B1");function O(e,n){if(1&e&&c.Pb(0,"nz-option",22),2&e){const e=n.$implicit;c.mc("nzValue",e.parameterDetailId)("nzLabel",e.fieldValue1)}}function C(e,n){if(1&e){const e=c.Vb();c.Ub(0,"button",28),c.bc("click",function(){c.vc(e);const n=c.ec().$implicit;return c.ec().onChangeState(n.profileMenuId,n.state)}),c.Pb(1,"i",29),c.Tb()}}function R(e,n){if(1&e){const e=c.Vb();c.Ub(0,"button",30),c.bc("click",function(){c.vc(e);const n=c.ec().$implicit;return c.ec().onChangeState(n.profileMenuId,n.state)}),c.Pb(1,"i",31),c.Tb()}}function G(e,n){if(1&e){const e=c.Vb();c.Ub(0,"tr"),c.Ub(1,"td",23),c.Hc(2),c.Tb(),c.Ub(3,"td",23),c.Hc(4),c.Tb(),c.Ub(5,"td",23),c.Hc(6),c.Tb(),c.Ub(7,"td",23),c.Hc(8),c.Tb(),c.Ub(9,"td",23),c.Ub(10,"button",24),c.bc("click",function(){c.vc(e);const t=n.$implicit;return c.ec().onOpenProfileMenuEditModal(t.profileMenuId)}),c.Pb(11,"i",25),c.Tb(),c.Tb(),c.Ub(12,"td",23),c.Fc(13,C,2,0,"button",26),c.Tb(),c.Ub(14,"td",23),c.Fc(15,R,2,0,"button",27),c.Tb(),c.Tb()}if(2&e){const e=n.$implicit,t=c.ec();c.Ab(2),c.Ic(e.profileName),c.Ab(2),c.Ic(e.menuName),c.Ab(2),c.Ic(e.systemName),c.Ab(2),c.Ic(e.stateName),c.Ab(5),c.mc("ngIf",t.state!==e.state),c.Ab(2),c.mc("ngIf",t.state===e.state)}}const _=[{path:"",component:(()=>{class e{constructor(e,n,t,i){this.fb=e,this.modalMessage=n,this.securityService=t,this.modalService=i,this.stateList=[],this.pageIndex=o.a.PAGINATION.PAGE_INDEX,this.pageSize=o.a.PAGINATION.PAGE_SIZE,this.sortProperty="",this.sortPropertyName="",this.totalRecord=0,this.state=o.a.STATE_ENTITY.ENABLE,this.tableProfileMenuLoading=!1,this.tableProfileMenu=[]}ngOnInit(){this.initForm(),this.initList()}initForm(){this.frmProfileMenu=this.fb.group({profilename:[null],menuname:[null],ddlstate:[null]})}initList(){Object(a.a)([this.securityService.getParameterDetailSearch({parameterId:o.a.PARAMETERS.ENTITY_STATE})]).subscribe(e=>{this.stateList=e[0]},e=>{this.modalMessage.error(o.a.MESSAGE.ERROR_GET_DATA)},()=>{this.onSearch()})}onSearch(){let e=null===this.frmProfileMenu.value.profilename?"":this.frmProfileMenu.value.profilename,n=null===this.frmProfileMenu.value.menuname?"":this.frmProfileMenu.value.menuname,t=null===this.frmProfileMenu.controls.ddlstate.value?0:this.frmProfileMenu.controls.ddlstate.value;this.tableProfileMenuLoading=!0,this.securityService.getProfileMenuFindAll({profileName:e,menuName:n,state:t,PageIndex:this.pageIndex,PageSize:this.pageSize,sort:this.sortProperty}).subscribe(e=>{this.tableProfileMenu=e.items,this.totalRecord=e.pagination.total,this.tableProfileMenuLoading=!1},e=>{this.tableProfileMenuLoading=!1,this.modalMessage.error(o.a.MESSAGE.ERROR_GET_DATA)})}onQueryParamsChange(e){const{pageSize:n,pageIndex:t,sort:i}=e;let r;this.pageIndex=t,this.pageSize=n,null!==i[0].value&&("ascend"==i[0].value&&(r="ASC"),"descend"==i[0].value&&(r="DESC"),"profilename"===i[0].key&&(this.sortProperty="profile_name "+r)),this.onSearch()}onOpenProfileMenuEditModal(e){this.modalService.create({nzTitle:o.a.MODAL_TITLE.REGISTER_PROFILE_MENU,nzClosable:!1,nzContent:L,nzComponentParams:{profileMenuId:e}}).afterClose.subscribe(e=>{void 0!==e&&this.onSearch()})}setCommand(e,n){return{profileMenuId:e,state:this.state===n?o.a.STATE_ENTITY.DISABLE:o.a.STATE_ENTITY.ENABLE,updateUserId:Object(l.d)(),updateUserFullname:Object(l.c)()}}onChangeState(e,n){this.modalMessage.confirm(o.a.MESSAGE.CONFIRM_QUESTION,()=>{this.tableProfileMenuLoading=!0,this.securityService.putProfileMenuChangeState(this.setCommand(e,n)).subscribe(()=>{this.onSearch()},e=>{this.tableProfileMenuLoading=!1,this.modalMessage.error(o.a.MESSAGE.ERROR)})})}}return e.\u0275fac=function(n){return new(n||e)(c.Ob(s.e),c.Ob(d.a),c.Ob(m.a),c.Ob(u.d))},e.\u0275cmp=c.Ib({type:e,selectors:[["app-profile-menu"]],decls:48,vars:28,consts:[["nz-form","","nzLayout","vertical",3,"formGroup"],["nzTitle","Perfiles Men\xfa"],["nz-row",""],["nz-col","",3,"nzSm","nzXs"],["nzFor","profilename"],["nz-input","","formControlName","profilename","placeholder","Perfil"],["nzFor","menuname"],["nz-input","","formControlName","menuname","placeholder","Men\xfa"],["nzFor","ddlstate"],["nzShowSearch","","nzAllowClear","","formControlName","ddlstate","nzPlaceHolder","Estados"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"text-right"],["nz-button","","nzType","primary",2,"margin-left","5px","margin-right","5px",3,"click"],["nz-icon","","nzType","plus"],["nz-button","","nzType","default",2,"margin-left","5px","margin-right","9px",3,"click"],["nz-icon","","nzType","search"],["nz-row","",1,"ant-form-item","mt-15"],["nzSize","small","nzShowSizeChanger","",3,"nzFrontPagination","nzLoading","nzData","nzTotal","nzPageIndex","nzPageSize","nzPageIndexChange","nzPageSizeChange","nzQueryParams"],["nzColumnKey","profilename",1,"tr-color",3,"nzAlign","nzSortFn"],[1,"tr-color",3,"nzAlign"],[1,"tr-color",3,"nzAlign","nzWidth"],[4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],["nzAlign","center"],["nz-button","","nzType","primary","nzTooltipTitle","Editar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-button","","nzTooltipTitle","Habilitar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click",4,"ngIf"],["nz-button","","nzTooltipTitle","Deshabilitar","nzTooltipPlacement","topLeft","nz-tooltip","","nzDanger","",3,"click",4,"ngIf"],["nz-button","","nzTooltipTitle","Habilitar","nzTooltipPlacement","topLeft","nz-tooltip","",3,"click"],["nz-icon","","nzType","like","nzTheme","outline"],["nz-button","","nzTooltipTitle","Deshabilitar","nzTooltipPlacement","topLeft","nz-tooltip","","nzDanger","",3,"click"],["nz-icon","","nzType","dislike","nzTheme","outline"]],template:function(e,n){1&e&&(c.Ub(0,"form",0),c.Ub(1,"nz-card",1),c.Ub(2,"div",2),c.Ub(3,"div",3),c.Ub(4,"nz-form-item"),c.Ub(5,"nz-form-label",4),c.Hc(6,"Perfil"),c.Tb(),c.Ub(7,"nz-form-control"),c.Pb(8,"input",5),c.Tb(),c.Tb(),c.Tb(),c.Ub(9,"div",3),c.Ub(10,"nz-form-item"),c.Ub(11,"nz-form-label",6),c.Hc(12,"Men\xfa"),c.Tb(),c.Ub(13,"nz-form-control"),c.Pb(14,"input",7),c.Tb(),c.Tb(),c.Tb(),c.Ub(15,"div",3),c.Ub(16,"nz-form-item"),c.Ub(17,"nz-form-label",8),c.Hc(18,"Estado"),c.Tb(),c.Ub(19,"nz-form-control"),c.Ub(20,"nz-select",9),c.Fc(21,O,1,2,"nz-option",10),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(22,"div",2),c.Ub(23,"div",3),c.Ub(24,"div",11),c.Ub(25,"button",12),c.bc("click",function(){return n.onOpenProfileMenuEditModal()}),c.Pb(26,"i",13),c.Hc(27," Nuevo"),c.Tb(),c.Ub(28,"button",14),c.bc("click",function(){return n.onSearch()}),c.Pb(29,"i",15),c.Hc(30,"Buscar"),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Ub(31,"div",16),c.Ub(32,"nz-table",17),c.bc("nzPageIndexChange",function(e){return n.pageIndex=e})("nzPageSizeChange",function(e){return n.pageSize=e})("nzQueryParams",function(e){return n.onQueryParamsChange(e)}),c.Ub(33,"thead"),c.Ub(34,"tr"),c.Ub(35,"th",18),c.Hc(36,"Perfil"),c.Tb(),c.Ub(37,"th",19),c.Hc(38,"Men\xfa"),c.Tb(),c.Ub(39,"th",19),c.Hc(40,"Sistema"),c.Tb(),c.Ub(41,"th",19),c.Hc(42,"Estado"),c.Tb(),c.Pb(43,"th",20),c.Pb(44,"th",20),c.Pb(45,"th",20),c.Tb(),c.Tb(),c.Ub(46,"tbody"),c.Fc(47,G,16,6,"tr",21),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()),2&e&&(c.mc("formGroup",n.frmProfileMenu),c.Ab(3),c.mc("nzSm",8)("nzXs",24),c.Ab(6),c.mc("nzSm",8)("nzXs",24),c.Ab(6),c.mc("nzSm",8)("nzXs",24),c.Ab(6),c.mc("ngForOf",n.stateList),c.Ab(2),c.mc("nzSm",24)("nzXs",24),c.Ab(9),c.mc("nzFrontPagination",!1)("nzLoading",n.tableProfileMenuLoading)("nzData",n.tableProfileMenu)("nzTotal",n.totalRecord)("nzPageIndex",n.pageIndex)("nzPageSize",n.pageSize),c.Ab(3),c.mc("nzAlign","center")("nzSortFn",!0),c.Ab(2),c.mc("nzAlign","center"),c.Ab(2),c.mc("nzAlign","center"),c.Ab(2),c.mc("nzAlign","center"),c.Ab(2),c.mc("nzAlign","center")("nzWidth","20px"),c.Ab(1),c.mc("nzAlign","center")("nzWidth","20px"),c.Ab(1),c.mc("nzAlign","center")("nzWidth","20px"),c.Ab(2),c.mc("ngForOf",n.tableProfileMenu))},directives:[s.r,s.n,f.b,s.i,U.a,z.c,z.a,f.c,f.d,f.a,v.b,s.d,s.m,s.h,p.d,g.m,T.a,S.a,M.a,y.a,N.c,N.j,N.k,N.b,N.i,N.h,N.a,N.f,p.a,F.d,g.n],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(n){return new(n||e)},imports:[[r.g.forChild(_)],r.g]}),e})(),x=(()=>{class e{}return e.\u0275mod=c.Mb({type:e}),e.\u0275inj=c.Lb({factory:function(n){return new(n||e)},imports:[[i.a,k]]}),e})()}}]);